(this["webpackJsonpandroid-rc-client"]=this["webpackJsonpandroid-rc-client"]||[]).push([[0],{19:function(e,n,t){e.exports=t(38)},24:function(e,n,t){},38:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),c=t(8),o=t.n(c),u=(t(24),t(3)),i=t(4),l=t(1),s=t(2);var f=Object(s.b)({key:"config/receiveOnly",default:!0}),b=Object(s.b)({key:"config/wsUrl",default:"wss://0j1sxcggc0.execute-api.ap-northeast-1.amazonaws.com/Dev"}),d=Object(s.b)({key:"config/roomId",default:function(e){for(var n=[];e--;)n.push("0123456789".charAt(Math.floor(Math.random()*"0123456789".length)));return n.join("")}(8)});function m(){return{wsUrl:Object(s.e)(b),roomId:Object(s.e)(d),receiveOnly:Object(s.e)(f)}}function O(e){var n=Object(s.d)(e),t=Object(l.a)(n,2),a=t[0],c=t[1];return[a,Object(r.useCallback)((function(e){return c(e.target.value)}),[c])]}function v(){var e=Object(u.a)(["\n    width: 12rem;\n    margin: 0 0.2rem;\n"]);return v=function(){return e},e}function j(){var e=Object(u.a)(["\n    margin: 1rem;\n"]);return j=function(){return e},e}function h(){var e=Object(u.a)(["\n    margin: 0 2rem;\n"]);return h=function(){return e},e}var p=i.b.form(h()),g=i.b.div(j()),y=i.b.input(v()),k=function(){var e=O(b),n=Object(l.a)(e,2),t=n[0],r=n[1],c=O(d),o=Object(l.a)(c,2),u=o[0],i=o[1];return a.a.createElement(p,null,a.a.createElement(g,null,a.a.createElement("label",{htmlFor:"url"},"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306eURL:"),a.a.createElement(y,{id:"url",type:"text",onChange:r,value:t})),a.a.createElement(g,null,a.a.createElement("label",{htmlFor:"roomId"},"\u90e8\u5c4b\u306eID:"),a.a.createElement(y,{id:"roomId",type:"text",onChange:i,value:u})))},x=t(5),E=t.n(x),C=t(7),w=t(12),S=Object(s.b)({key:"streams/localStream",default:null}),M=Object(s.b)({key:"streams/remoteStream",default:null}),R=Object(s.b)({key:"streams/remoteAudioStream",default:null}),D=Object(s.b)({key:"streams/dataChannel",default:null});function I(){return{localStream:Object(s.e)(S),remoteStream:Object(s.e)(M),remoteAudioStream:Object(s.e)(R),dataChannel:Object(s.e)(D)}}var U=Object(s.b)({key:"messages",default:[]});function z(){var e=Object(u.a)(["\n    opacity: 0.5;\n    cursor: default;\n"]);return z=function(){return e},e}function L(){var e=Object(u.a)(["\n    height: 2.75em;\n    width: 8em;\n    margin: 0 5px 20px 5px;\n    padding: 0.5em 0.7em 0.5em 0.7em;\n    background-color: #4285f4;\n    border: none;\n    border-radius: 2px;\n    box-shadow: 1px 1px 5px 0 rgba(0, 0, 0, 0.5);\n    color: white;\n    font-size: 0.8em;\n    cursor: pointer;\n    ","\n"]);return L=function(){return e},e}function P(){var e=Object(u.a)(["\n    margin: 0 2rem;\n"]);return P=function(){return e},e}var T=i.b.div(P()),A=i.b.button(L(),(function(e){return e.disabled&&B})),B=Object(i.a)(z()),F=function(){var e=Object(r.useState)(!0),n=Object(l.a)(e,2),t=n[0],c=n[1],o=Object(r.useState)(!1),u=Object(l.a)(o,2),i=u[0],f=u[1],b=Object(r.useState)(),d=Object(l.a)(b,2),O=d[0],v=d[1],j=m(),h=I().localStream,p=Object(s.f)(S),g=Object(s.f)(M),y=Object(s.f)(R),k=Object(s.f)(D),x=Object(s.c)((function(e){var n=e.snapshot,t=e.set;return function(){var e=Object(C.a)(E.a.mark((function e(r){var a,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getPromise(U);case 2:for(a=e.sent,(c=Object.assign([],a)).push(r);c.length>10;)c.shift();t(U,c);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()})),z=Object(r.useCallback)((function(){null!==h&&h.getTracks().forEach((function(e){return e.stop()})),p(null),c(!0),f(!1)}),[h,p]),L=Object(r.useCallback)(Object(C.a)(E.a.mark((function e(){var n,t,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c(!1),n=w.defaultOptions,j.receiveOnly&&(n.audio.direction="recvonly",n.video.direction="recvonly"),(t=Object(w.connection)(j.wsUrl,j.roomId,n)).on("disconnect",(function(){g(null),k(null),x("Disconnected."),z()})),t.on("addstream",(function(e){console.log("addstream",e.track.kind),"audio"===e.track.kind?(y(e.streams[0]),x("Connected to remote audio.")):(g(e.streams[0]),x("Connected to remote client."))})),t.on("open",(function(){v(t),t.createDataChannel("android-rc data",{ordered:!0}).then((function(e){k(e),x("  Created Data Channel. ".concat(null!=e))})),x("Connected to signaling server."),f(!0)})),t.on("connect",(function(){x("  Connect P2P Channel.")})),t.on("datachannel",(function(e){k(e),x("  Receive Data Channel. ".concat(null!=e))})),r=null,j.receiveOnly){e.next=14;break}return e.next=13,navigator.mediaDevices.getUserMedia({audio:!0,video:!0});case 13:r=e.sent;case 14:return x("Start a ".concat(j.receiveOnly?"receive only ":"","connection.")),e.next=17,t.connect(r);case 17:p(r);case 18:case"end":return e.stop()}}),e)}))),[j.receiveOnly,j.roomId,j.wsUrl,z,x,y,k,p,g]),P=Object(r.useCallback)((function(){null!=O&&O.disconnect(),z()}),[O,z]);return a.a.createElement(T,null,a.a.createElement(A,{type:"button",onClick:L,disabled:!t},"\u63a5\u7d9a"),a.a.createElement(A,{type:"button",onClick:P,disabled:!i},"\u5207\u65ad"))};function J(){var e=Object(u.a)(["\n    color: #333;\n"]);return J=function(){return e},e}function N(){var e=Object(u.a)(["\n    margin: 1rem;\n    padding: 0.5rem;\n    border: solid 1px #333;\n"]);return N=function(){return e},e}var W=i.b.div(N()),X=i.b.div(J()),Y=function(){var e=Object(s.e)(U);return a.a.createElement(W,null,e.map((function(e,n){return a.a.createElement(X,{key:n},e)})))};var q=1;function G(e,n){null!=e&&"open"===e.readyState?(n.id=q++,e.send(JSON.stringify(n))):console.warn("Fail to send event. Because the data channel is null or not opened.",n)}function H(){var e=Object(u.a)(["\n    z-index: 2;\n    position: absolute;\n    border: 1px solid gray;\n    bottom: 0px;\n    right: 20px;\n    max-height: 30%;\n    max-width: 30%;\n    transition: opacity 1s;\n"]);return H=function(){return e},e}function K(){var e=Object(u.a)(["\n    max-height: 90%;\n    max-width: 90%;\n    object-fit: contain;\n    transition: opacity 1s;\n"]);return K=function(){return e},e}function Q(){var e=Object(u.a)(["\n                  display: none;\n              "]);return Q=function(){return e},e}function V(){var e=Object(u.a)(["\n                  background: rgba(0, 0, 0, 0.6);\n              "]);return V=function(){return e},e}function Z(){var e=Object(u.a)(["\n    font-size: 0;\n    position: absolute;\n    transition: all 1s;\n    height: 100%;\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n\n    ","\n"]);return Z=function(){return e},e}function $(e){var n=e.currentTarget.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top,t:Math.floor(e.timeStamp)}}var _=i.b.div(Z(),(function(e){return e.shown?Object(i.a)(V()):Object(i.a)(Q())})),ee=i.b.video(K()),ne=i.b.video(H()),te=function(){var e=m().receiveOnly,n=Object(r.useRef)(null),t=Object(r.useRef)(null),c=Object(r.useRef)(null),o=I(),u=o.localStream,i=o.remoteStream,s=o.remoteAudioStream,f=o.dataChannel,b=Object(r.useState)(!1),d=Object(l.a)(b,2),O=d[0],v=d[1],j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=Object(r.useState)(e),t=Object(l.a)(n,2),a=t[0],c=t[1],o=Object(r.useCallback)((function(e){var n=a.concat(e);c(n)}),[a]),u=Object(r.useCallback)((function(){c([])}),[]);return[a,o,u]}(),h=Object(l.a)(j,3),p=h[0],g=h[1],y=h[2];Object(r.useLayoutEffect)((function(){n.current&&(n.current.srcObject=u)}),[u]),Object(r.useLayoutEffect)((function(){t.current&&(t.current.srcObject=i)}),[i]),Object(r.useLayoutEffect)((function(){c.current&&(c.current.srcObject=s)}),[s]),Object(r.useEffect)((function(){var e=new ResizeObserver((function(e){var n=Math.ceil(e[0].contentRect.width),t=Math.ceil(e[0].contentRect.height);console.log(" Send Config Event: height=".concat(t,", width=").concat(n)),G(f,{id:0,type:"config",data:{height:t,width:n}})}));return t.current&&e.observe(t.current),function(){e.disconnect()}}),[f]);var k=Object(r.useCallback)((function(e){v(!0),g(e)}),[g]),x=Object(r.useCallback)((function(e){var n=p.concat(e);console.log("  Send Touch Events",n),function(e,n){G(e,{id:0,type:"touch",data:n})}(f,n),v(!1),y()}),[y,f,p]),E=Object(r.useCallback)((function(e){var n=$(e);console.log("onMouseDown",e,n),k(n)}),[k]),C=Object(r.useCallback)((function(e){if(O){var n=$(e);console.log("onMouseUp",e,n),x(n)}}),[x,O]),w=Object(r.useCallback)((function(e){if(O){var n=$(e);console.log("onMouseLeave",e,n),x(n)}}),[x,O]);return a.a.createElement(_,{shown:null!=i},a.a.createElement(ee,{ref:t,autoPlay:!0,onMouseDown:E,onMouseUp:C,onMouseLeave:w}),a.a.createElement("audio",{ref:c,autoPlay:!0}),!e&&a.a.createElement(ne,{ref:n,autoPlay:!0,muted:!0}))};function re(){var e=Object(u.a)(["\n    flex: 1;\n"]);return re=function(){return e},e}function ae(){var e=Object(u.a)(["\n    margin: 2rem;\n    font-size: 2rem;\n"]);return ae=function(){return e},e}function ce(){var e=Object(u.a)(["\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    justify-items: center;\n"]);return ce=function(){return e},e}var oe=i.b.div(ce()),ue=i.b.div(ae()),ie=i.b.div(re()),le=function(){return a.a.createElement(oe,null,a.a.createElement(ue,null,"WebRTC Test Client."),a.a.createElement(k,null),a.a.createElement(F,null),a.a.createElement(ie,null),a.a.createElement(Y,null),a.a.createElement(te,null))};o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(s.a,null,a.a.createElement(le,null))),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.171de777.chunk.js.map